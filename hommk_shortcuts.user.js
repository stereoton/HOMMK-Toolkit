// ==UserScript==
// @name HkShortcuts
// @version 2012.01.15.11.49.580000
// @description HOMMK Shortcuts · Werkzeugkasten für MMHK
// @author Gelgamek <gelgamek@arcor.de>
// @copyright Gelgamek et al., Artistic License 2.0, http://www.opensource.org/licenses/Artistic-2.0
// @icon http://icons.iconarchive.com/icons/webiconset/mobile/32/maps-icon.png
// @namespace http://mightandmagicheroeskingdoms.ubi.com/play
// @match http://mightandmagicheroeskingdoms.ubi.com/play*
//
// Content Scope Runner:
// @require http://userscripts.org/scripts/source/68059.user.js
// ==/UserScript==

if('undefined' == typeof __PAGE_SCOPE_x_8c08997c_0c21_44a8_94e9_ce439d11b873_RUN__) { (function page_scope_runner() {
	// If we're _not_ already running in the page, grab the full source
	// of this script.
	var my_src = "(" + page_scope_runner.caller.toString() + ")();";
	
	// Create a script node holding this script, plus a marker that lets us
	// know we are running in the page scope (not the Greasemonkey sandbox).
	// Note that we are intentionally *not* scope-wrapping here.
	var script = document.createElement('script');
	script.setAttribute("type", "text/javascript");
	script.textContent = "var __PAGE_SCOPE_x_8c08997c_0c21_44a8_94e9_ce439d11b873_RUN__ = true;\n" + my_src;
	
	// Insert the script node into the page, so it will run, and immediately
	// remove it to clean up. Use setTimeout to force execution "outside" of
	// the user script scope completely.
	setTimeout(function() {
		document.body.appendChild(script);
		document.body.removeChild(script);
	}, 0);
})();return; }if(!window.localStorage){Object.defineProperty(window,"localStorage",new (function(){var a=[],b={};Object.defineProperty(b,"getItem",{value:function(c){return c?this[c]:null},writable:false,configurable:false,enumerable:false});Object.defineProperty(b,"key",{value:function(c){return a[c]},writable:false,configurable:false,enumerable:false});Object.defineProperty(b,"setItem",{value:function(c,e){if(!c){return}document.cookie=escape(c)+"="+escape(e)+"; path=/"},writable:false,configurable:false,enumerable:false});Object.defineProperty(b,"length",{get:function(){return a.length},configurable:false,enumerable:false});Object.defineProperty(b,"removeItem",{value:function(e){if(!e){return}var c=new Date();c.setDate(c.getDate()-1);document.cookie=escape(e)+"=; expires="+c.toGMTString()+"; path=/"},writable:false,configurable:false,enumerable:false});this.get=function(){var c;for(var g in b){c=a.indexOf(g);if(c===-1){b.setItem(g,b[g])}else{a.splice(c,1)}delete b[g]}for(a;a.length>0;a.splice(0,1)){b.removeItem(a[0])}for(var e,f,i=0,h=document.cookie.split(/\s*;\s*/);i<h.length;i++){e=h[i].split(/\s*=\s*/);if(e.length>1){b[f=unescape(e[0])]=unescape(e[1]);a.push(f)}}return b};this.configurable=false;this.enumerable=true})())}if("undefined"==typeof window.console){window.console={log:function log(a){return a}}}else{window.console.logNative=window.console.log;window.console.log=function(c,b){if("function"==typeof window.console.logNative){var a=("undefined"!=typeof window.$debug?window.$debug:(("undefined"!=typeof b)?b:0));if(a>=1){window.console.logNative(c)}if(a>1){alert(c)}}return c}}if("undefined"==typeof window.HkLogger){var HkLogger=new Class({log:function log(a){window.console.log(a)}});window.HkLogger=HkLogger}if("undefined"==typeof HkFinder){var HkFinder=new Class({getRecursive:function getRecursive(c,b){var e=this;var a=b;var f=c.split(".");if(!f.every(function(i,h,g){if(!e.hasOwnProperty(i)){return false}e=e.val;if(h+1>=g.length){a=e}return true},null)){return b}return a}})}try{if("undefined"==typeof window.console){window.console={log:function log(a){}}}}catch(ex){}if("undefined"==typeof window.HkStylesGeneric){window.HkStylesGeneric=new Class({initialize:function(){},applyStyles:function applyStyles(){$A(this.styles).each(function(b,a){var e,c=b;if(c.selector.indexOf(".")!=-1||c.selector.indexOf("#")!=-1){e=$$(c.selector)}else{e=$(c.selector.substr(1))}if(e){if("undefined"==typeof e.length){e=[e]}e=$A(e);e.each(function(g,f){window.console.log("Weise Stile zu\u2026");window.console.log(g);window.console.log(c.styles);$each(c.styles,function(h,i){window.console.log("Weise Wert '"+h+"' zu für Stil "+i);if(g.style[i]!=""&&!c.force){window.console.log("Wert existiert bereits, Zuweisung nicht erzwungen\u2026");return}else{window.console.log("Wert existiert bereits, Zuweisung erzwungen\u2026")}window.console.log("Alter Wert: "+g.style[i]);g.style[i]=h})})}})},styles:[{selector:".GradientGreyDarkgreyGrey",styles:{background:"linear-gradient(top, #202020, #040404 20%, #040404 40%, #303030)"}},{selector:".GradientGreyDarkgreyGrey",styles:{background:"-webkit-linear-gradient(top, #202020, #040404 20%, #040404 40%, #303030)"}},{selector:".GradientGreyDarkgreyGrey",styles:{background:"-moz-linear-gradient(top, #202020, #040404 20%, #040404 40%, #303030)"}},{force:true,selector:".Radius5",styles:{"border-radius":"5px"}},{force:true,selector:".Radius5BottomLeft",styles:{"border-bottom-left-radius":"5px"}},{force:true,selector:".Radius10",styles:{"border-radius":"10px"}},{force:true,selector:".Radius10TopLeft",styles:{"border-top-left-radius":"5px"}},{force:true,selector:".Radius10TopRight",styles:{"border-top-right-radius":"5px"}},{force:true,selector:".HkButton",styles:{border:"none"}}]});var HkStylesGeneric=window.HkStylesGeneric}else{window.console.log("[HkStylesGeneric][WARN]Klasse existiert bereits: "+Json.toString(window.HkStylesGeneric))}if("undefined"==typeof $E){function $E(a,b){return($(b)||document).getElement(a)}function $ES(a,b){return($(b)||document).getElementsBySelector(a)}$$.shared={regexp:/^(\w*|\*)(?:#([\w-]+)|\.([\w-]+))?(?:\[(\w+)(?:([!*^$]?=)["']?([^"'\]]*)["']?)?])?$/,xpath:{getParam:function(b,e,f,c){var a=[e.namespaceURI?"xhtml:":"",f[1]];if(f[2]){a.push('[@id="',f[2],'"]')}if(f[3]){a.push('[contains(concat(" ", @class, " "), " ',f[3],' ")]')}if(f[4]){if(f[5]&&f[6]){switch(f[5]){case"*=":a.push("[contains(@",f[4],', "',f[6],'")]');break;case"^=":a.push("[starts-with(@",f[4],', "',f[6],'")]');break;case"$=":a.push("[substring(@",f[4],", string-length(@",f[4],") - ",f[6].length,' + 1) = "',f[6],'"]');break;case"=":a.push("[@",f[4],'="',f[6],'"]');break;case"!=":a.push("[@",f[4],'!="',f[6],'"]')}}else{a.push("[@",f[4],"]")}}b.push(a.join(""));return b},getItems:function(b,f,h){var g=[];var a=document.evaluate(".//"+b.join("//"),f,$$.shared.resolver,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(var e=0,c=a.snapshotLength;e<c;e++){g.push(a.snapshotItem(e))}return(h)?g:new Elements(g.map($))}},normal:{getParam:function(a,c,f,b){if(b==0){if(f[2]){var e=c.getElementById(f[2]);if(!e||((f[1]!="*")&&(Element.getTag(e)!=f[1]))){return false}a=[e]}else{a=$A(c.getElementsByTagName(f[1]))}}else{a=$$.shared.getElementsByTagName(a,f[1]);if(f[2]){a=Elements.filterById(a,f[2],true)}}if(f[3]){a=Elements.filterByClass(a,f[3],true)}if(f[4]){a=Elements.filterByAttribute(a,f[4],f[5],f[6],true)}return a},getItems:function(a,b,c){return(c)?a:$$.unique(a)}},resolver:function(a){return(a=="xhtml")?"http://www.w3.org/1999/xhtml":false},getElementsByTagName:function(e,c){var f=[];for(var b=0,a=e.length;b<a;b++){f.extend(e[b].getElementsByTagName(c))}return f}};$$.shared.method=(window.xpath)?"xpath":"normal";Element.Methods.Dom={getElements:function(a,k){var c=[];a=a.trim().split(" ");for(var f=0,e=a.length;f<e;f++){var g=a[f];var h=g.match($$.shared.regexp);if(!h){break}h[1]=h[1]||"*";var b=$$.shared[$$.shared.method].getParam(c,this,h,f);if(!b){break}c=b}return $$.shared[$$.shared.method].getItems(c,this,k)},getElement:function(a){return $(this.getElements(a,true)[0]||false)},getElementsBySelector:function(a,f){var e=[];a=a.split(",");for(var c=0,b=a.length;c<b;c++){e=e.concat(this.getElements(a[c],true))}return(f)?e:$$.unique(e)}};Element.extend({getElementById:function(c){var b=document.getElementById(c);if(!b){return false}for(var a=b.parentNode;a!=this;a=a.parentNode){if(!a){return false}}return b},getElementsByClassName:function(a){return this.getElements("."+a)}});document.extend(Element.Methods.Dom);Element.extend(Element.Methods.Dom)}if("undefined"==typeof Scroller){var Scroller=new Class({options:{area:20,velocity:1,onChange:function(a,b){this.element.scrollTo(a,b)}},initialize:function(b,a){this.setOptions(a);this.element=$(b);this.mousemover=([window,document].contains(b))?$(document.body):this.element},start:function(){this.coord=this.getCoords.bindWithEvent(this);this.mousemover.addListener("mousemove",this.coord)},stop:function(){this.mousemover.removeListener("mousemove",this.coord);this.timer=$clear(this.timer)},getCoords:function(a){this.page=(this.element==window)?a.client:a.page;if(!this.timer){this.timer=this.scroll.periodical(50,this)}},scroll:function(){var a=this.element.getSize();var e=this.element.getPosition();var c={x:0,y:0};for(var b in this.page){if(this.page[b]<(this.options.area+e[b])&&a.scroll[b]!=0){c[b]=(this.page[b]-this.options.area-e[b])*this.options.velocity}else{if(this.page[b]+this.options.area>(a.size[b]+e[b])&&a.scroll[b]+a.size[b]!=a.scrollSize[b]){c[b]=(this.page[b]-a.size[b]+this.options.area-e[b])*this.options.velocity}}}if(c.y||c.x){this.fireEvent("onChange",[a.scroll.x+c.x,a.scroll.y+c.y])}}});Scroller.implement(new Events,new Options)}if(String.prototype.toCurrency==null){String.prototype.toCurrency=function toCurrency(){var b=this.toString();var a=/^(.*\s)?([\-+\u00A3\u20AC]?\d+)(\d{3}\b)/;return b==(b=b.replace(a,"$1$2,$3"))?b:this.toCurrency(b)}}if(String.prototype.padLeft==null){String.prototype.padLeft=function padLeft(b,c){var a=this.toString();while(a.length<b){a=c+a}return a}}if(Number.prototype.toK==null){Number.prototype.toK=function toK(){var b=Number(this.toString());var a=Number(Math.abs(b));if((a.toInt()/1000000)>=1){return b.toFixedString(1000000,1,true)+"M"}if((a.toInt()/1000)>=1){return b.toFixedString(1000)+"K"}return b}}if(Number.prototype.toFixedString==null){Number.prototype.toFixedString=function toFixedString(){var i=this.toString();var h,g,c;var b=Array.prototype.slice.call(arguments);if(b.length>2){h=b.shift()}else{h=1}g=b.shift();c=b.shift();i=i/h;var f=parseFloat((i||"0").toString().replace(",",".").replace(/[^0-9e\.\-+]/g,""))||0;var e=Number(Math.abs(i)).toUnsignedString(g);if(isNaN(e)){e=0}e=(f<0?"-":"")+e;if(c==true){return e.toCurrency()}return Number(e)}}if(Number.prototype.toFixedString==null){Number.prototype.toUnsignedString=function toUnsignedString(c){var g=this.toString();var f,a,b;var e=""+Math.round(g*Math.pow(10,c));if(/\D/.test(e)){return""+g}e=e.padLeft(1+c,"0");f=e.substring(0,b=(e.length-c));a=e.substring(b);if(a){a="."+a}return f+a}}if(Node.prototype.preventTextSelection==null){var applyToTags=["p","h1","h2","h3","h4","h5","h6","li","a","img"];Node.prototype.preventTextSelection=function(b){if($type(this)!="element"){return this}if(!applyToTags.contains(this.getTag())){return this}var a={"-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-o-user-select":"none","user-select":"none"};this.setStyles(a);return this}}window.HkStylesExtra={Shortcuts:{list:{paddingTop:"2px",paddingBottom:"2px",marginLeft:"0px",marginRight:"0px",marginTop:"0px",marginBottom:"0px",clear:"both","float":"none",backgroundColor:"#0e0e0e",height:"auto",maxHeight:"800px",width:"auto",maxWidth:"1200px"},Form:{inputX:{verticalAlign:"middle"},inputY:{verticalAlign:"middle"},inputName:{verticalAlign:"middle",width:"90%"},submit:{margin:"0px",verticalAlign:"middle",cursor:"pointer"},load:{margin:"0px",verticalAlign:"middle",cursor:"pointer"},gotoPosition:{margin:"0px",verticalAlign:"middle",cursor:"pointer"},error:{},valid:{}},Entry:{deleteButton:{cursor:"pointer","float":"right",paddingTop:"3px"},text:{cursor:"pointer",width:"auto",marginLeft:"2px",marginRight:"20px",paddingTop:"3px",paddingBottom:"3px"},entry:{padding:"2px 0px",borderTop:"1px solid #303030",clear:"both"}},},window:{zIndex:"95000",margin:"auto",display:"block",position:"absolute",border:"1px solid #000","border-top-left-radius":"5px","border-top-right-radius":"5px",top:"50px",left:"auto",bottom:"auto",right:"auto",width:"auto",height:"auto",backgroundColor:"#0e0e0e",color:"#f2f2f2",overflow:"none",paddingBottom:"0px",borderTopLeftRadius:"10px",borderTopRightRadius:"10px",borderBottomLeftRadius:"5px"},footer:{clear:"both","float":"none",marginTop:"0px",paddingTop:"3px",paddingBottom:"0px",marginBottom:"0px",marginLeft:"0px",marginRight:"0px",height:"auto",width:"100%",backgroundColor:"#1a1a1a"},donate:{display:"block","float":"right",width:"auto",marginLeft:"auto"},scrollArea:{"float":"left",marginLeft:"0px",height:"16px",width:"auto",},scrollButton:{cursor:"pointer"},content:{margin:"0px",marginBottom:"0px",paddingTop:"2px",paddingBottom:"2px",overflow:"hidden",height:"48px",minHeight:"32px",maxHeight:"800px",width:"160px",minWidth:"120px",maxWidth:"1200px"},header:{zIndex:"96000",marginTop:"0px",marginBottom:"5px",paddingTop:"1px",paddingBottom:"1px",paddingLeft:"5px",paddingRight:"5px",borderTopLeftRadius:"10px",borderTopRightRadius:"10px",backgroundColor:"#1a1a1a"},title:{fontSize:"0.8em",paddingLeft:"3px",backgroundColor:"transparent",paddingBottom:"2px",marginTop:"4px",marginBottom:"2px",marginRight:"auto",width:"auto"},reduceButton:{zIndex:"97000",cursor:"pointer","float":"right",width:"22px",height:"18px",backgroundPosition:"-110px",backgroundRepeat:"no-repeat",backgroundImage:'url("http://cgit.compiz.org/fusion/decorators/emerald/plain/defaults/theme/buttons.min.png")'},updateLink:{zIndex:"97000",verticalAlign:"middle","float":"right",paddingTop:"2px",fontSize:"0px"},updateButton:{zIndex:"97000",border:" none"},resizeButton:{zIndex:"97000",verticalAlign:"middle","float":"right",cursor:"se-resize",border:" none",width:"12px",height:"12px",backgroundPosition:"0px 0px",backgroundImage:"url(http://openiconlibrary.sourceforge.net/gallery2/open_icon_library-full/icons_by_subject/graphics/png/32x32/cursor-corner-bottom-right.png)"},closeButton:{}};try{window.$debug=0;var AssetLoader=new Class({initialize:function(a){this.completed=[];this.waiting=[];if(!!a){this.injectJavascript(a)}},injectJavascript:function injectJavascript(a){this.scriptsToInject=a;$each(a,function(b,c){this.waiting.push(c)},this);$each(a,function(b,c){if(!$(c)){this.inject(b,c)}else{this.setInjected(c)}},this)},inject:function inject(scriptDef,scriptName){if($(scriptName)){$(scriptName).remove()}var url=scriptDef.hasOwnProperty("url")?scriptDef.url:false;var conditions=scriptDef.hasOwnProperty("conditions")?eval(scriptDef.conditions):true;if(url&&conditions&&!$(scriptName)){new Asset.javascript(url,{id:scriptName})}this.check.delay(200,this,[scriptDef,scriptName])},check:function check(scriptDef,scriptName){var conditions=scriptDef.hasOwnProperty("conditions")?eval(scriptDef.conditions):false;if(conditions){this.inject.delay(1000,this,[scriptDef,scriptName])}else{this.setInjected(scriptName)}},setInjected:function setInjected(a){this.completed.push(a);this.waiting.remove(a)}});try{window.assetLoader=new AssetLoader({SHA256CryptoJs:{url:"http://crypto-js.googlecode.com/files/2.5.3-crypto-sha256.js"}})}catch(ex){window.console.log("[AssetLoader][ERROR]"+ex)}window.hkCreateClasses=function(){window.console.log("[HkPublic][DEBUG]Erzeuge Klassen\u2026");window.HkStore={};try{}catch(at){window.console.log("[HkDataStorage][ERROR]"+at)}try{window.Hk=new Class({idScript:"HkToolkit",version:"2012.01.15.11.49.580000",Coords:{lastRegion:{x:0,y:0},lastGoto:{x:0,y:0},regExp:/\(?\s*([0-9]+)\s*[,.\-]\s*([0-9]+)\s*\)?/},doNothing:Class.empty,initialize:function(){try{this.HOMMK=window.HOMMK;this.Player=this.HOMMK.player;this.PlayerId=this.Player.get("id");this.UserId=this.Player.get("userId");this.AllianceId=this.Player.get("allianceId");this.AllianceName=this.Player.get("allianceName");this.Map=this.HOMMK.worldMap;this.WorldSize=this.Map.get("_size");this.WorldId=this.Player.get("worldId")}catch(x){window.console.log("[Hk][ERROR]Hk-Initialisierung fehlgeschlagen: "+x)}},getRegionName:function ax(az,aD){if(arguments.length==1){var aB=this.HOMMK.getXYFromRegionNumber();az=aB.x;aD=aB.y}var aA=window.HOMMK.getRegionFromXY(az,aD);var aC="";if(aA.content.hasOwnProperty("cN")){aC+=aA.content.cN;if(aA.content.hasOwnProperty("pN")&&!!aA.content.pN){aC+=", "+aA.content.pN}if(aA.content.hasOwnProperty("iAN")&&!!aA.content.iAN){aC+=" ("+aA.content.iAN+")"}}else{if(aA.content.hasOwnProperty("rB")){aC+=aA.content.rB.n;if(aA.content.rB.hasOwnProperty("owner")&&!!aA.content.rB.owner){aC+="("+aA.content.rB.owner.name+")"}}else{aC+="Region #"+window.HOMMK.getRegionNumberFromXY(az,aD)}}return aC},fixPosition:function ai(x){if(x>this.WorldSize){return x-this.WorldSize}return x},validatePosition:function av(x){x=new Number(x).round();if(isNaN(x)||x<=0||x>this.WorldSize){return false}return x},gotoPosition:function V(az,aC,aA){var aB;if(!$defined(aA)){aA=window.HOMMK.REGION_WORLDMAP_ZOOM_13X13}aB=window.HOMMK.getRegionNumberFromXY(az,aC);if(!this.validatePosition(az)||!this.validatePosition(aC)){return false}window.HOMMK.setCurrentView(aA,aB,az,aC);return true},getCurrentX:function ay(){return this.validatePosition(this.Coords.lastRegion.x||window.HOMMK.currentView.regionX)},getCurrentY:function aw(){return this.validatePosition(this.Coords.lastRegion.y||window.HOMMK.currentView.regionY)}})}catch(at){window.console.log("[Hk][ERROR]"+at)}var ad=window.Hk;try{window.hkToolkit=new ad();window.hk=window.hkToolkit}catch(at){window.console.log("[HkToolkit][ERROR]"+at)}var L=window.hk;var m=L.HOMMK;var z=L.idScript;var p=L.version;window.HOMMK_HkToolkit=window.HOMMK_HkToolkit?window.HOMMK_HkToolkit:{version:L.version};window.console.log("[PUBLIC][DEBUG]Starte HkToolkit\u2026");try{window.Hk.HkStorage=new Class({$debug:1,storageKey:"HkStorage"+window.hk.PlayerId+""+window.hk.WorldId,options:{storageKey:"HkStorage"+window.hk.PlayerId+""+window.hk.WorldId,clearStorage:false},initialize:function(x){try{window.console.log("[HkPublic][DEBUG]Bereite HkStorage vor\u2026");this.setOptions(x);this.storageKey=this.options.storageKey;window.console.log("[HkPublic][DEBUG]Initialisiere HkStorage #"+this.storageKey);if(this.options.clearStorage){this.clearStorage()}if(this.isEmpty()){window.console.log("[HkStorage][DEBUG]Erzeuge lokalen Speicher für #"+this.storageKey);this.setStorageData({})}}catch(y){window.console.log("[HkStorage][ERROR]Initialisierungsfehler: "+y)}},drop:function G(x){window.console.log("[HkStorage][DEBUG]Entferne "+x+" aus "+this.storageKey);var y=this.getStorageData();if($defined(y.key)||y.hasOwnProperty(x)){var az=y[x];delete y[x];this.setStorageData(y);return az}else{window.console.log("[HkStorage][INFO]Kein Eintrag "+x+" in "+this.storageKey)}return false},dropAll:function ah(){var x=this.pull();window.console.log("[HkStorage][DEBUG]Entferne Daten aus "+this.storageKey);if(x){$each(x,function(az,y){window.console.log("[HkStorage][DEBUG]Verarbeite "+y);this.drop(y)}.bind(this))}},push:function b(x,y){if(arguments.length<2){window.console.log("[HkStorage][DEBUG]Speichere Daten: "+Json.toString(x))}else{window.console.log("[HkStorage][DEBUG]Speichere Daten unter #"+x+": "+Json.toString(y))}var az=this.getStorageData();if(arguments.length<2){$each(x,function(aB,aA){az[aA]=aB})}else{az[x]=y}this.setStorageData(az)},pull:function k(x){var az=this.getStorageData();if("null"==typeof az){window.console.log("[HkStorage.pull][DEBUG]null-Datentyp im Speicher");az={}}else{window.console.log("[HkStorage.pull][DEBUG]Datentyp im Speicher: "+typeof az)}if(!x){window.console.log("[HkStorage][DEBUG]Kein Schlüssel angefragt, liefere alle Daten zurück: "+Json.toString(x));var aA={};for(d in az){window.console.log("[HkStorage][DEBUG]Prüfe Eintrag: "+Json.toString(d));if("function"==$type(az[d])){continue}window.console.log("[HkStorage][DEBUG]Eintrag akzeptiert.");aA[d]=az[d]}return aA}if(!az.hasOwnProperty(x)){return{}}var y=az[x];return y},isEmpty:function h(x){var y=$H(this.getStorageData()).keys();if(y==null||y.length<=0){window.console.log("[HkStorage][DEBUG]Keine Daten in #"+this.storageKey+": "+Json.toString(y));return true}return false},getStorageData:function ac(){var x=window.localStorage.getItem(this.storageKey);window.console.log("[HkStorage][DEBUG]Abgerufene Daten aus #"+this.storageKey+": "+Json.toString(x));if(null==typeof x||!x){return{}}x=Json.evaluate(x);return x},setStorageData:function T(y){var x=Json.toString(y);window.console.log("[HkStorage][DEBUG]Speichere Daten in #"+this.storageKey+": "+x);window.localStorage.setItem(this.storageKey,x);this.fireEvent("onStorageUpdate",y);return y},clearStorage:function B(){window.console.log("[HkStorage][DEBUG]Leere Speicher...");window.localStorage.clear();this.fireEvent("onStorageUpdate",{})}});window.Hk.HkStorage.implement(new Events,new Options)}catch(at){window.console.log("[HkStorage][ERROR]"+at);throw new Exception(at)}try{L.Storage={Common:new ad.HkStorage()}}catch(at){window.console.log("[HkStorage.Common][ERROR]"+at);throw new Exception(at)}ad.HkReducer=new Class({$debug:1,$status:null,$default:"TargetVisible",IS_REDUCED:"TargetReduced",IS_VISIBLE:"TargetVisible",options:{duration:500},initialize:function(x,az,y){this.setOptions(y);this.toggle=x;this.target=az;var aA=this.options;aA.onChange=function(aB){window.console.log("[HkReducer][Event]Slider Change Event");window.console.log(aB);this.fireEvent("onTargetChange",[this.toggle,this.target])}.bind(this);aA.onTick=function(aB){window.console.log("[HkReducer][Event]Slider Tick Event");window.console.log(aB);this.fireEvent("onTargetStep",[this.toggle,this.target])}.bind(this);aA.onComplete=function(aB){window.console.log("[HkReducer][Event]Slider Complete Event");window.console.log(aB);this.$status=(this.$status==this.IS_REDUCED)?this.IS_VISIBLE:this.IS_REDUCED;this.fireEvent("on"+this.$status,[this.toggle,this.target]);this.updateDimensions(this.target);this.fireEvent("onTargetComplete",[this.toggle,this.target])}.bind(this);this.toggle.slider=new Fx.Slide(this.target,aA);this.toggle.target=this.target;this.toggle.reducer=this;this.target.reducer=this;this.toggle.addEvent("mousedown",this.togglePressed.bind(this));this.toggle.addEvent("click",this.toggleClicked.bind(this));if(this.$status==null){this.$status=this.$default}window.console.log(this.toggle.slider);this.updateDimensions(this.target)},togglePressed:function F(y){var x=y.target;var aA=x.target;var az=x.slider;if(this.$status==this.IS_VISIBLE){window.console.log("[HkReducer][Event]Target height: "+aA.style.height)}else{window.console.log("[HkReducer][Event]Target height: "+aA.style.height)}},toggleClicked:function ag(y){var x=y.target;var aA=x.target;var az=x.slider;if(this.$status==this.IS_VISIBLE){az.slideOut()}else{az.slideIn()}},updateDimensions:function g(aB){window.console.log("[HkReducer][DEBUG]Passe die Größen an\u2026");var aA=aB.getElementsByTagName("div");$each(aA,function(aE){var aF=$(aE).getStyle("height");var aD=aE.id||"N/A";window.console.log("[HkReducer][DEBUG]Passe die Höhe des Containers #"+aD+" an ("+aF+")\u2026");if($chk(aF)&&aF.toInt()<=0&&aF!="auto"){window.console.log("[HkReducer][DEBUG]Setze Höhe des Containers #"+aD+": "+aF+" \u2192 auto\u2026");aE.setStyle("height","auto")}else{window.console.log("[HkReducer][DEBUG]Lasse die Höhe des Containers #"+aD+" unverändert ("+aF+")\u2026")}});var y=aB.id||"N/A";var x=$(aB).getStyle("height");window.console.log("[HkReducer][DEBUG]Setze Höhe des Hauptelements #"+y+": "+x+" \u2192 auto\u2026");aB.setStyle("height","auto");var az=$(aB.getParent).getStyle("height");var aC=aB.getParent().getCoordinates().height+"px";window.console.log("[HkReducer][DEBUG]Setze Höhe des Slide-Elements: "+az+" \u2192 "+aC+"\u2026");aB.getParent().setStyle("height",aC)}});ad.HkReducer.implement(new Events,new Options);L.Storage.HkWindows=new ad.HkStorage({storageKey:"HkWindowsInternal"});ad.HkWindows=new Class({$debug:1,storage:window.hk.Storage.HkWindows,windows:[],options:{id:"HkWindow",reduceable:true,closeable:false,draggable:true,resizeable:true,scrollable:true,autoScroll:true,title:"HkWindow",createHeader:true,createTitle:true,createContentContainer:true,createDonateButton:false,preventTextSelection:true,addToDOM:true,reduce:false,updateable:true,updateUrl:"http://userscripts.org/scripts/source/121763.user.js",scroller:false,scrollers:{up:Class.empty,down:Class.empty},windowStyles:window.HkStylesExtra.window,footerStyles:window.HkStylesExtra.footer,donateStyles:window.HkStylesExtra.donate,scrollAreaStyles:window.HkStylesExtra.scrollArea,scrollButtonStyles:window.HkStylesExtra.scrollButton,resizeButtonStyles:window.HkStylesExtra.resizeButton,headerStyles:window.HkStylesExtra.header,titleStyles:window.HkStylesExtra.title,reduceButtonStyles:window.HkStylesExtra.reduceButton,closeButtonStyles:window.HkStylesExtra.closeButton,updateButtonStyles:window.HkStylesExtra.updateButton,updateLinkStyles:window.HkStylesExtra.updateLink,contentStyles:window.HkStylesExtra.content,},initialize:function(x){this.setOptions(x);this.options.scrollers.up=this.scrollUp;this.options.scrollers.down=this.scrollDown},createWindow:function P(y,aF){this.setOptions(aF);var aD=this.getWindowId(y,aF);var x=new Element("div",{id:aD,"class":"HkWindow Radius5BottomLeft Radius10TopLeft Radius10TopRight",styles:this.options.windowStyles});var aA;if(this.options.createContentContainer){aA=this.createContentContainer(y,aF)}else{aA=new Object}if(this.options.createHeader){var aE=this.createHeader(y,aF);x.adopt(aE);if(this.options.draggable){new Drag.Move(x,{handle:aE,hkWindow:this,hkWindowId:y,onComplete:function(aG){window.console.log("[HkWindow][DEBUG]Drag Complete Event an "+this.options.hkWindowId);if(!this.options.hkWindow.saveWindowPosition(this.options.hkWindowId,this.options.hkWindow.options)){window.console.log("[HkWindow][DEBUG]Drag Event Handler saveWindowPosition fehlgeschlagen für "+x.hkWindowId)}}})}}if(this.options.createContentContainer){x.adopt(aA)}var aC=this.createFooter(y,aF);if(this.options.resizeable){window.console.log("[HkWindow][DEBUG]Erzeuge Resize-Button für "+y);var aB=this.createResizeButton(y,aF);aC.adopt(aB)}if(this.options.scrollable&&!this.options.autoScroll){var az=this.createScrollArea(y,aF);aC.adopt(az)}x.adopt(aC);if(this.options.addToDOM){$("MainContainer").adopt(x);if(this.options.resizeable){this.makeResizeable(y,aF,aA)}this.windows.push(x)}this.loadWindowPosition(y,aF);return x},getWindowNode:function au(az,x){window.console.log("[HkWindow][DEBUG]Rufe Fenster-Knoten für "+az);var y=$(this.getWindowId(az,x));return"undefined"==typeof y?null:y},getWindowPosition:function I(aA,x){var y=this.getWindowNode(aA,x);if(y==null){return null}var az=y.getPosition();window.console.log("[HkWindow][DEBUG]Abgerufene Fensterposition für  "+y.id+": "+Json.toString(az));return az},setWindowPosition:function K(aB,aA,x){var az=this.getWindowNode(aA,x);if(az==null){return null}window.console.log("[HkWindow][DEBUG]Setze Fensterposition für  "+az.id+": "+Json.toString(aB));if("undefined"==typeof aB||!aB||!("x" in aB)||!("y" in aB)){return null}var y={top:aB.y,left:aB.x};az.setStyles(y);return y},loadWindowPosition:function l(aB,x){var az=this.getWindowNode(aB,x);if(az==null){return null}var y="WindowPosition"+az.id;var aA=this.storage.pull(y);window.console.log("[HkWindow][DEBUG]Geladene Fensterposition für  "+y+": "+Json.toString(aA));if("undefined"==typeof aA||!aA||!("x" in aA)||!("y" in aA)){aA=this.saveWindowPosition(aB,x)}this.setWindowPosition(aA,aB,x);return aA},saveWindowPosition:function J(aB,x){var az;if((az=this.getWindowNode(aB,x))==null){return null}var y="WindowPosition"+az.id;var aA=this.getWindowPosition(aB,x);window.console.log("[HkWindow][DEBUG]Speichere Fensterposition für  "+y+": "+Json.toString(aA));this.storage.push(y,aA);return aA},showScrollButtons:function a(y,x){},hideScrollButtons:function af(y,x){},createFooter:function ar(aB,az){this.setOptions(az);var aA=this.getId("HkWindowFooter",aB,az);var x=new Element("div",{id:aA,"class":"Radius5BottomLeft",styles:this.options.footerStyles});if(this.options.createDonateButton){var y=new Element("form",{action:"https://www.paypal.com/cgi-bin/webscr",method:"post",target:"_blank",alt:"Unterstütze den Entwickler!",title:"Unterstütze den Entwickler!",name:"Unterstütze den Entwickler!",styles:this.options.donateStyles});y.innerHTML='<input type="hidden" name="cmd" value="_s-xclick"><input type="hidden" name="hosted_button_id" value="WRWUH9K7JBMBY"><input type="image" src="http://icons.iconarchive.com/icons/visualpharm/magnets/16/coins-icon.png" border="0" name="submit" title="Den Entwickler unterstützen!" name="Den Entwickler unterstützen!" alt="Den Entwickler unterstützen!"><img alt="" border="0" src="https://www.paypalobjects.com/de_DE/i/scr/pixel.gif" width="1" height="1">';x.adopt(y)}return x},createScrollArea:function e(aA,x){this.setOptions(x);var y=this.getId("HkWindowScrollers",aA,x);var az=new Element("div",{id:y,styles:this.options.scrollAreaStyles});$each(this.options.scrollers,function(aD,aB){var aC=this.createScrollButton(aA,x,aB,aD);az.adopt(aC)}.bind(this));return az},createScrollButton:function aa(aC,x,aA,y){this.setOptions(x);if(aA!="up"&&aA!="down"){aA="down"}var aB=this.getId("HkWindowScroll"+aA,aC,x);var az=new Element("img",{id:aB,src:"http://icons.iconarchive.com/icons/saki/nuoveXT/16/Small-arrow-"+aA+"-icon.png",styles:this.options.scrollButtonStyles});az.dir=aA;az.srcId=aC;az.btnId=aB;az.btnOpts=x;az.btnWindow=this;az.addEvent("click",y.bind(this));return az},scrollUp:function ap(az){window.console.log("[HkWindow][DEBUG]scrollUp:");var aB=az.target.btnWindow.getWindowId(az.target.srcId,az.target.btnOpts);window.console.log("[HkWindow][DEBUG]Fenster-ID: "+aB);var y=$(aB).getElement(".HkContent");window.console.log(y.getSize());var aA=y.getSize().size;var x=y.getSize().scroll;var aC=y.getSize().scrollSize;var aD=x.y-20<0?0:x.y-20;window.console.log("[HkWindow][DEBUG]Scrolle zu Y="+aD);y.scrollTo(x.x,aD);window.console.log(y.getSize())},scrollDown:function H(az){window.console.log("[HkWindow][DEBUG]scrollDown:");var aB=az.target.btnWindow.getWindowId(az.target.srcId,az.target.btnOpts);window.console.log("[HkWindow][DEBUG]Fenster-ID: "+aB);var y=$(aB).getElement(".HkContent");window.console.log(y.getSize());var aA=y.getSize().size;var x=y.getSize().scroll;var aC=y.getSize().scrollSize;var aD=x.y+aA.y+20>aC.y?aC.y-aA.y:x.y+20;window.console.log("[HkWindow][DEBUG]Scrolle zu Y="+aD);y.scrollTo(x.x,aD);window.console.log(y.getSize())},getId:function n(y,az,x){return y+$pick($pick(az,this.options.id),this.id)},getWindowId:function D(y,x){return this.getId("HkWindow",y,x)},createHeader:function q(aD,aA){this.setOptions(aA);var aB=this.getId("HkWindowHeader",aD,aA);var y=new Element("div",{id:aB,"class":"HkWindowHeader GradientGreyDarkgreyGrey Radius10TopLeft Radius10TopRight",styles:this.options.headerStyles});if(this.options.reduceable){var x=this.createReduceButton(aD,aA);y.adopt(x)}if(this.options.updateable){var az=this.createUpdateButton(aD,aA);y.adopt(az)}if(this.options.createTitle){var aC=this.createTitle(aD,aA);y.adopt(aC)}return y},createTitle:function o(aA,x){this.setOptions(x);var y=this.getId("HkWindowTitle",aA,x);var az=new Element("h1",{id:y,"class":"HkWindowTitle Radius10TopLeft Radius10TopRight",styles:this.options.titleStyles});az.setText(this.options.title);if(this.options.preventTextSelection){az.preventTextSelection()}if(this.options.draggable){new Drag.Move($(this.getWindowId(aA,x)),{handle:az});az.setStyles({cursor:"move"})}return az},createUpdateButton:function r(aA,az){this.setOptions(az);var x=new Element("a",{href:this.options.updateUrl,target:"_blank",styles:this.options.updateLinkStyles});var y=new Element("img",{alt:"Erzwinge Aktualisierung",title:"Erzwinge Aktualisierung",name:"Erzwinge Aktualisierung",src:"http://icons.iconarchive.com/icons/saki/snowish/16/Apps-system-software-update-icon.png",styles:this.options.updateButtonStyles});x.adopt(y);if(this.options.preventTextSelection){x.preventTextSelection()}return x},createCloseButton:function v(az,y){this.setOptions(y);var x=new Element("div",{"class":"HkClose HkButton",styles:this.options.closeButtonStyles});return x},createContentContainer:function M(aA,y){this.setOptions(y);var az=this.getId("HkWindowContent",aA,y);var x=new Element("div",{id:az,"class":"HkContent",styles:this.options.contentStyles});if(this.options.preventTextSelection){x.preventTextSelection()}return x},makeScrollable:function al(az,y){this.setOptions(y);if(!this.options.scroll||!this.options.autoScroll){return}var x=$(this.options.scroll);this.options.scroller=new Scroller(x);this.options.scroller.start()},createReduceButton:function ae(az,y){this.setOptions(y);var x=new Element("div",{"class":"HkReduce HkButton",title:"Einrollen",name:"Einrollen",styles:this.options.reduceButtonStyles});x.setOpacity("0.8");if(this.options.preventTextSelection){x.preventTextSelection()}return x},makeReduceable:function N(aB,az){this.setOptions(az);if(!this.options.reduce){return}var aA=$(this.options.reduce);var y=$(this.getWindowId(aB)).getElementsByTagName("div");var x=false;$each(y,function(aC){aC=$(aC);if(aC.hasClass("HkReduce")){x=aC}});if(x&&aA){new ad.HkReducer(x,aA,{hkWindowId:aB,hkWindow:this})}},createResizeButton:function ab(aA,x){var az=this.getId("HkWindowResize",aA,x);var y=new Element("div",{id:az,"class":"HkWindowResizeButton",styles:this.options.resizeButtonStyles});if(this.options.preventTextSelection){y.preventTextSelection()}return y},makeResizeable:function s(aA,y,x){this.setOptions(y);if(!this.options.resizeable){return}var az=this.getId("HkWindowResize",aA,y);x=$(($defined(x)?x:this.getId("HkWindow",aA,y)));this.resizeElement=$(x);window.console.log("[HkWindow][DEBUG]Erzeuge Resizeable-Funktion via "+az);new Drag.Base(x,{handle:$(az),hkResize:this.resizeElement,hkWindow:this,hkWindowId:aA,modifiers:{x:"width",y:"height"},onStart:function(aB){window.console.log("[HkWindow][Event]Resize Start Event an "+this.options.hkWindowId)},onDrag:function(aB){window.console.log("[HkWindow][Event]Resize Event an "+this.options.hkWindowId)},onComplete:function(aB){window.console.log("[HkWindow][Event]Resize Complete Event an "+this.options.hkWindowId);if(this.options.hkWindow.options.reduceable){window.console.log("[HkWindow][DEBUG]Löse Höhenfestlegung durch Reduceable für "+this.options.hkWindowId);var aC=aB.getParent();if(aC.getStyle("overflow")=="hidden"&&aC.getStyle("height")!="auto"){aC.setStyle("height","auto")}}if(!this.options.hkWindow.saveWindowSize(this.options.hkWindowId,this.options.hkWindow.options)){window.console.log("[HkWindow][WARN]Resize Event Handler saveWindowSize fehlgeschlagen für "+this.options.hkWindowId)}}})},getWindowSize:function Z(aA,x){var az=this.resizeElement||this.getWindowNode(aA,x);if(az==null){return null}var y=az.getSize();window.console.log("[HkWindow][DEBUG]Abgerufene Fenstergröße für  "+az.id+": "+Json.toString(y));return y},setWindowSize:function R(az,aB,y){var aA=this.resizeElement||this.getWindowNode(aB,y);if(aA==null){return null}window.console.log("[HkWindow][DEBUG]Setze Fenstergröße für  "+aA.id+": "+Json.toString(az));if("undefined"==typeof az||!az||!("size" in az)||!("x" in az.size)||!("y" in az.size)){return null}var x={width:az.size.x,height:az.size.y};aA.setStyles(x);return x},loadWindowSize:function O(aB,x){var aA=this.resizeElement||this.getWindowNode(aB,x);if(aA==null){return null}var az="WindowSize"+aA.id;var y=this.storage.pull(az);window.console.log("[HkWindow][DEBUG]Geladene Fenstergröße für  "+az+": "+Json.toString(y));if("undefined"==typeof y||!y||!("size" in y)||!("x" in y.size)||!("y" in y.size)){y=this.saveWindowSize(aB,x)}this.setWindowSize(y,aB,x);return y},saveWindowSize:function ao(aB,x){var aA=this.resizeElement||this.getWindowNode(aB,x);if(aA==null){return null}var az="WindowSize"+aA.id;var y=this.getWindowSize(aB,x);window.console.log("[HkWindow][DEBUG]Speichere Fenstergröße für  "+az+": "+Json.toString(y));this.storage.push(az,y);return y}});ad.HkWindows.implement(new Events,new Options);L.Windows=new ad.HkWindows();ad.Shortcut=new Class({$debug:1,options:{x:-1,y:-1,name:""},initialize:function W(az,aC,aB){var aA;if(arguments.length==1){aA=az}else{aA={x:az,y:aC,name:aB}}this.setOptions(aA)},isValid:function S(){var x=window.hk.validatePosition(this.x());var y=window.hk.validatePosition(this.y());if(!x||!y){return false}return this.name().length>0},x:function u(){return this.options.x},y:function t(){return this.options.y},name:function Q(){return this.options.name},toString:function X(){return Json.toString(this.options)}});ad.Shortcut.implement(new Options);L.Storage.Shortcuts=new ad.HkStorage({storageKey:window.hk.idScript+"HkShortcuts"+window.hk.PlayerId+""+window.hk.WorldId,});if(L.Storage.Shortcuts.isEmpty()){var i=window.hk.Storage.Common.pull();if(i){$each(i,function(y,x){if(x!="WindowPositionHkWindowHkShortcuts"&&x!="WindowPositionHkWindowHkExplorer"){window.hk.Storage.Shortcuts.push(x,y)}else{window.hk.Storage.Common.pull(x)}})}}ad.HkShortcutsWindow=new Class({$debug:1,$cleanStorage:0,$hkWin:false,inputStyles:{valid:{border:"1px solid #030303"},error:{border:"1px solid #fa0c0c"}},initialize:function W(){if(this.$debug==1){window.hk.Storage.Shortcuts.$debug=1;window.hk.Storage.Common.$debug=1;window.hk.$debug=1}if(this.$cleanStorage==1&&!window.hk.Storage.Common.isEmpty()){window.console.log("[HkShortcutsWindow][DEBUG]Leere Shortcut-Speicher...");window.hk.Storage.Shortcuts.dropAll()}if(window.hk.Storage.Shortcuts.isEmpty()){window.console.log("[HkShortcutsWindow][DEBUG]Shortcut-Speicher leer, versuche Migration\u2026");var x=window.hk.Storage.Common.pull();window.console.log("[HkShortcutsWindow][DEBUG]Migrationsdaten: "+Json.toString(x));if(x){$each(x,function(az,y){window.console.log("[HkShortcutsWindow][DEBUG]Verarbeite "+y);if(y!="WindowPositionHkWindowHkShortcuts"&&y!="WindowPositionHkWindowHkExplorer"){window.hk.Storage.Shortcuts.push(y,az);window.hk.Storage.Common.drop(y)}else{window.hk.Storage.Common.drop(y)}})}}window.hk.Storage.Shortcuts.addEvent("onStorageUpdate",this.updateShortcutList);this.$hkWin=window.hk.Windows.createWindow("HkShortcuts",{title:"HkShortcuts"});this.createContent(this.$hkWin,window.hk.Windows,window.hk.Storage.Shortcuts)},cleanStorage:function(y){if(y.isEmpty()){window.console.log("[HkShortcutsWindow][DEBUG]Leere Speicher #"+y.options.storageKey);var x=window.hk.Storage.Common.pull();window.console.log("[HkShortcutsWindow][DEBUG]Migrationsdaten: "+Json.toString(x));if(x){$each(x,function(aA,az){window.console.log("[HkShortcutsWindow][DEBUG]Verarbeite "+az);if(az!="WindowPositionHkWindowHkShortcuts"&&az!="WindowPositionHkWindowHkExplorer"){window.hk.Storage.Shortcuts.push(az,aA)}else{window.hk.Storage.Common.drop(az)}})}}},loadCurrentPosition:function C(){window.console.log("[HkShortcutsWindow][DEBUG]Lade Shortcut...");$("ShortcutInputX").value=window.hk.getCurrentX();window.hk.Shortcuts.validateData("ShortcutInputX");$("ShortcutInputY").value=window.hk.getCurrentY();window.hk.Shortcuts.validateData("ShortcutInputY");var x=window.hk.getRegionName(window.hk.getCurrentX(),window.hk.getCurrentY());$("ShortcutInputName").value=x},resetData:function A(x){var y;if($chk(x)&&x){y=this.inputStyles.error.border}else{y=this.inputStyles.valid.border}$("ShortcutInputX").value="";$("ShortcutInputX").setStyles({border:y});$("ShortcutInputY").value="";$("ShortcutInputY").setStyles({border:y})},validateData:function U(y){var x=$(y).value;if(window.hk.validatePosition(x)){$(y).setStyle("border",this.inputStyles.valid.border)}},getCurrentData:function aq(){var aB=$("ShortcutInputX").value;var aC=$("ShortcutInputY").value;var aA=$("ShortcutInputName").value;var az=new window.Hk.Shortcut(aB,aC,aA);return az},createShortcut:function f(y){y.preventDefault();var x=window.hk.Shortcuts.getCurrentData();if(x.isValid()){window.hk.Storage.Shortcuts.push(x.name(),x.options)}else{this.resetData(true)}},shortcutClicked:function c(aC){window.console.log("[HkShortcutsWindow][DEBUG]Rufe Shortcut auf");var aD=aC.target;window.console.log("[HkShortcutsWindow][DEBUG]Shortcut-Eintrag: "+aD);while(aD.getTag()!="div"){aD=aD.getParent();window.console.log("[HkShortcutsWindow][DEBUG]Shortcut-Eintrag: "+aD)}var aB=aD.getProperty("name");window.console.log("[HkShortcutsWindow][DEBUG]Rufe Werte des Eintrags "+aB+" ab");var aA=window.hk.Storage.Shortcuts.pull(aB);window.console.log("[HkShortcutsWindow][DEBUG]Werte des Eintrags: "+Json.toString(aA));var az=aA.x;var aE=aA.y;window.console.log("[HkShortcutsWindow][DEBUG]Gehe zu Shortcut: "+az+", "+aE);window.hk.gotoPosition(az,aE)},gotoCurrentPosition:function am(){var x=window.hk.Shortcuts.getCurrentData();window.hk.gotoPosition(x.x(),x.y())},updateShortcutList:function aj(){window.console.log("[HkShortcutsWindow][DEBUG]Aktualisiere Shortcut-Liste");$("ShortcutList").empty();var x=window.hk.Storage.Shortcuts.pull();if(x){$each(x,function(aA,az){var y=new window.Hk.Shortcut(aA);window.hk.Shortcuts.addShortcutToList(y)})}window.hk.Shortcuts.updateDimensions()},updateDimensions:function g(){var x=$("ShortcutList").getElementsByTagName("div");$each(x,function(y){var az=$(y).getStyle("height");if($chk(az)&&az.toInt()<=0){y.setStyle("height","auto")}});$("ShortcutList").setStyle("height","auto")},addShortcutToList:function w(x){window.console.log("[HkShortcutsWindow][DEBUG]Shortcut: "+Json.toString(x.options));var aA=x.name()+"   ("+x.x()+", "+x.y()+")";window.console.log("[HkShortcutsWindow][DEBUG]Shortcut: "+aA);var az=new Element("p",{"class":"EntryText EntryLink",styles:window.HkStylesExtra.Shortcuts.Entry.text});az.setText(aA);az.preventTextSelection();az.addEvent("click",this.shortcutClicked);var aB=new Element("img",{"class":"EntryButton DeleteButton",name:"delete"+x.name(),title:"Eintrag löschen",alt:"Eintrag löschen",src:"http://icons.iconarchive.com/icons/oxygen-icons.org/oxygen/16/Actions-dialog-close-icon.png",styles:window.HkStylesExtra.Shortcuts.Entry.deleteButton});aB.addEventListener("click",this.onDeleteShortcut);var y=new Element("div",{"class":"hkScLEntry",name:x.name(),styles:window.HkStylesExtra.Shortcuts.Entry.entry});y.adopt(aB);y.adopt(az);az.addEventListener("click",this.shortcutClicked);$("ShortcutList").adopt(y)},onDeleteShortcut:function j(az){window.console.log("[HkShortcutsWindow][DEBUG]Rufe Shortcut auf");var aA=az.target;window.console.log("[HkShortcutsWindow][DEBUG]Shortcut-Eintrag: "+aA);while(aA.getTag()!="div"){aA=aA.getParent();window.console.log("[HkShortcutsWindow][DEBUG]Shortcut-Eintrag: "+aA)}var y=aA.getProperty("name");window.console.log("[HkShortcutsWindow][DEBUG]Entferne Eintrag "+y+"\u2026");var x=window.hk.Storage.Shortcuts.drop(y);window.console.log("[HkShortcutsWindow][DEBUG]Entfernter Eintrag: "+Json.toString(x));window.hk.Shortcuts.updateDimensions()},nameInputHasFocus:function Y(x){if(!($chk($("ShortcutInputX").value)||$chk($("ShortcutInputY").value))){window.hk.Shortcuts.loadCurrentPosition()}},inputFocusLost:function an(x){window.hk.Shortcuts.validateData(x.target.id)},createContent:function ak(y,aA,aI){var aB=y.getElement(".HkContent");aB.setStyle("paddingTop","0px");var aD=new Element("form",{id:"ShortcutForm",name:"inputForm"});aD.setStyles({paddingTop:"0px",verticalAlign:"middle"});aD.addEventListener("submit",this.createShortcut);var az=new Element("div",{id:"ShortcutList",styles:window.HkStylesExtra.Shortcuts.list});var aF=new Element("input",{id:"ShortcutInputX",name:"inputX",size:3,maxlength:3,styles:window.HkStylesExtra.Shortcuts.Form.inputX});aF.addEventListener("blur",this.inputFocusLost);var aE=new Element("input",{id:"ShortcutInputY",name:"inputY",size:3,maxlength:3,styles:window.HkStylesExtra.Shortcuts.Form.inputY});aE.addEventListener("blur",this.inputFocusLost);var aC=new Element("input",{id:"ShortcutInputName",name:"inputName",styles:window.HkStylesExtra.Shortcuts.Form.inputName});aC.addEventListener("focus",this.nameInputHasFocus);var aH=new Element("img",{id:"GotoPosition",name:"gotoPosition",alt:"Springe zu angegebenen Koordinaten",title:"Springe zu angegebenen Koordinaten",src:"http://icons.iconarchive.com/icons/itzikgur/my-seven/16/Favorities-icon.png",styles:window.HkStylesExtra.Shortcuts.Form.gotoPosition});aH.preventTextSelection();aH.addEventListener("click",this.gotoCurrentPosition);var aG=new Element("img",{id:"LoadPosition",name:"loadPosition",alt:"Lade Informationen der aktuellen Kartenposition",title:"Lade Informationen der aktuellen Kartenposition",src:"http://icons.iconarchive.com/icons/fatcow/farm-fresh/16/update-icon.png",styles:window.HkStylesExtra.Shortcuts.Form.load});aG.preventTextSelection();aG.addEventListener("click",this.loadCurrentPosition);var x=new Element("img",{id:"ShortcutSubmit",name:"shortcutSubmit",alt:"Speichern",title:"Speichern",src:"http://icons.iconarchive.com/icons/fatcow/farm-fresh/16/accept-icon.png",styles:window.HkStylesExtra.Shortcuts.Form.submit});x.preventTextSelection();x.addEventListener("click",this.createShortcut);aD.adopt(aF,aE,aH,aG,x,aC);aB.adopt(aD,az)}});ad.HkShortcutsWindow.implement(new Events,new Options);window.initHkToolkit=function E(){window.console.log("[HkPublic][DEBUG]Initialisiere HkToolkit\u2026");try{window.hk.Shortcuts=new window.Hk.HkShortcutsWindow()}catch(x){window.console.log("[HkPublic][ERROR]Fehler beim Erzeugen des Shortcuts-Fensters: "+x)}try{window.hk.Shortcuts.updateShortcutList()}catch(x){window.console.log("[HkPublic][ERROR]Fehler beim Aktualisieren des Shortcuts-Fensters: "+x)}try{window.hk.Windows.makeReduceable("HkShortcuts",{reduce:$("HkWindowContentHkShortcuts"),title:"HkShortcuts"});window.hk.Windows.makeScrollable("HkShortcuts",{scroll:$("HkWindowContentHkShortcuts"),title:"HkShortcuts"});window.hk.Shortcuts.updateDimensions()}catch(x){window.console.log("[HkPublic][ERROR]Fehler bei der Finalisierung des Shortcuts-Fensters: "+x)}if("undefined"==typeof window.hkStylesGeneric){try{window.hkStylesGeneric=new window.HkStylesGeneric()}catch(x){window.console.log("[HkPublic][ERROR]Fehler bei der Finalisierung des Shortcuts-Fensters: "+x)}}window.hkStylesGeneric.applyStyles()};return window.initHkToolkit};window.console.log("Erzeuge Loader-Objekt\u2026");window.HkToolkitLoader={loaded:false,load:function load(){if(window.HkToolkitLoader.loaded){window.console.log("[HkToolkitLoader][DEBUG]HkToolkit geladen\u2026");try{window.HkToolkitLoaderActive=$clear(window.HkToolkitLoaderActive);delete window.HkToolkitLoader}catch(b){window.console.log("[HkToolkitLoader][Error]Fehler beim Beenden des Loaders: "+b)}return}window.console.log("[HkToolkitLoader][DEBUG]Warte auf Hk\u2026");if(!!(window.HOMMK&&window.HOMMK.worldMap&&window.hkCreateClasses&&window.assetLoader&&window.assetLoader.waiting.length==0)){window.console.log("[HkToolkitLoader][DEBUG]Hk verfügbar, bereite HkToolkit vor\u2026");try{window.HkToolkitLoader.loaded=true;var a=window.hkCreateClasses();a()}catch(b){window.console.log("[HkToolkitLoader][ERROR]Fehler beim Erzeugen der Klassen für HkToolkit: "+b)}}else{window.console.log("[HkToolkitLoader][DEBUG]HkToolkit wartet auf die Verfügbarkeit von Hk.")}}};window.console.log("Starte Loader\u2026");try{window.HkToolkitLoaderActive=window.HkToolkitLoader.load.periodical(1000)}catch(ex){window.console.log("[HkPublic][DEBUG]Fehler beim Laden von HkToolkit: "+ex)}}catch(ex){window.console.log("[HkPublic][ERROR]Unbekannter Fehler: "+ex)};